<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Copyright 2017 Sergio Teruel <sergio.teruel@tecnativa.com>
         License LGPL-3.0 or later (http://www.gnu.org/licenses/lgpl). -->
    <template id="payment" inherit_id="website_sale.payment">
        <xpath expr="//div[hasclass('js_payment')]" position="after">
            <div class="float-left mt-2" t-if="website.checkout_skip_payment">
                <a role="button" href="/shop/cart" class="btn btn-secondary">
                    <i class="fa fa-chevron-left"/>
                    Return to Cart
                </a>
            </div>
            <div class="js_skip_payment mt-3" t-if="website.checkout_skip_payment" id="skip_payment_method">
                <form target="_self" action="/shop/confirmation" method="post" class="float-right">
                    <input type="hidden" name="csrf_token" t-att-value="request.csrf_token()" />
                    <a role="button" class="btn btn-primary a-submit" href="#">
                        <span>Confirm Order <span class="fa fa-chevron-right"></span></span>
                    </a>
                </form>
            </div>
        </xpath>
        <xpath expr="//div[@id='payment_method']" position="attributes">
            <attribute name="t-if">(acquirers or tokens) and website_sale_order.amount_total and not website.checkout_skip_payment</attribute>
        </xpath>
        <xpath expr="//div[hasclass('js_payment')]" position="attributes">
            <attribute name="t-if">not website_sale_order.amount_total and not website.checkout_skip_payment</attribute>
        </xpath>
    </template>

    <template id="confirmation_bista" inherit_id="website_sale.confirmation">
        <xpath expr="//h1" position="replace">
            <h2 class="pt32 mb32"><span>Order</span> <em t-field="order.name"/> <t t-if="order.state == 'sale'"><span t-if="order.state == 'done'">Confirmed</span></t></h2>
        </xpath>
        <xpath expr='//t[@t-if="payment_tx_id.state == &apos;done&apos;"]' position="replace">
            <div class="thanks_msg">
                <h2>Thank you for your order.
                    <a role="button" class="btn btn-primary pull-right d-none d-md-inline-block" href="/shop/print" target="_blank" aria-label="Print" title="Print"><i class="fa fa-print"/> Print</a>
                </h2>
            </div>
        </xpath>
        <xpath expr="//t[@t-call='website_sale.payment_confirmation_status']"
               position="after">
            <div class="alert alert-info" role="alert"
                 t-if="website.checkout_skip_payment">
                Our team will check your order and send you payment
                information soon.
            </div>
        </xpath>
        <!-- Hide payment related info if skip payment step -->
        <xpath expr="//t[@t-call='website_sale.payment_confirmation_status']"
               position="attributes">
            <attribute name="t-if">not website.checkout_skip_payment</attribute>
        </xpath>

        <xpath expr="//div[@class='card mt-3']" position="replace">
            <div class="row">
                <h3 class='mt32'>&amp;nbsp;</h3>
                <t t-call='website_sale_checkout_skip_payment.bill_to'>
                    <t t-set="order" t-value= "order"/>
                </t>
            </div>
        </xpath>
    </template>

    <template id="order_state_message">
      <p>Your order is waiting manual confirmation.</p><br/>
    </template>

    <template id='website_sale_checkout_skip_payment.bill_to' name="Bill to">
        <div class="col-md-6 oe_address">
          <div class="panel-heading">Bill To:</div>
          <div class="panel-body">
            <div class='o_div_text_overflow' t-field="order.partner_invoice_id" t-options="{'widget': 'contact','fields': ['address', 'name', 'phone', 'email']}" />
          </div>
        </div>
        <t t-if="not order.only_services" groups="sale.group_delivery_invoice_address">
            <div class="col-md-6 oe_address">
              <div class="panel-heading">Ship To:</div>
              <div class="panel-body">
                <div class='o_div_text_overflow' t-field="order.partner_shipping_id" t-options="{'widget': 'contact','fields': ['address', 'name', 'phone']}" />
              </div>
            </div>
        </t>
    </template>

</odoo>
